{"version":3,"sources":["Components.js"],"names":["define","langx","$","Vvveb","tmpl","inputs","jQuery","Components","base_sort","_components","_nodesLookup","_attributesLookup","_classesLookup","_classesRegexLookup","componentPropertiesElement","get","type","this","add","data","nodes","i","attributes","constructor","Array","classes","classesRegex","extend","inheritType","newData","inheritData","properties","merge","sort","a","b","matchNode","node","component","tagName","length","attr","name","value","j","split","regex","regexObj","RegExp","exec","toLowerCase","render","rightPanel","section","find","preservePropertySections","html","append","key","header","beforeInit","Builder","selectedEl","fn","property","input","on","event","element","child","parent","onChange","htmlAttr","oldValue","validValues","removeClass","join","addClass","css","Undo","addMutation","target","attributeName","newValue","selectNode","nodeElement","group","inputtype","init","setValue","getStyle","filter","el","indexOf","SectionInput","row","afterInit"],"mappings":"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","file":"../Components.js","sourcesContent":["define([\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-utils-dom/query\",\r\n\t\"./Vvveb\",\r\n\t\"./tmpl\",\r\n\t\"./inputs\"\r\n],function(langx,$,Vvveb,tmpl,inputs){\r\n\tvar jQuery = $;\r\n\r\n\t\r\n\treturn Vvveb.Components = {\r\n    \tbase_sort : 100,//start sorting for base component from 100 to allow extended properties to be first\r\n\t\t\r\n\t\t_components: {},\r\n\t\t\r\n\t\t_nodesLookup: {},\r\n\t\t\r\n\t\t_attributesLookup: {},\r\n\r\n\t\t_classesLookup: {},\r\n\t\t\r\n\t\t_classesRegexLookup: {},\r\n\t\t\r\n\t\tcomponentPropertiesElement: \"#right-panel .component-properties\",\r\n\r\n\t\tget: function(type) {\r\n\t\t\treturn this._components[type];\r\n\t\t},\r\n\r\n\t\tadd: function(type, data) {\r\n\t\t\tdata.type = type;\r\n\t\t\t\r\n\t\t\tthis._components[type] = data;\r\n\t\t\t\r\n\t\t\tif (data.nodes) \r\n\t\t\t{\r\n\t\t\t\tfor (var i in data.nodes)\r\n\t\t\t\t{\t\r\n\t\t\t\t\tthis._nodesLookup[ data.nodes[i] ] = data;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (data.attributes) \r\n\t\t\t{\r\n\t\t\t\tif (data.attributes.constructor === Array)\r\n\t\t\t\t{\r\n\t\t\t\t\tfor (var i in data.attributes)\r\n\t\t\t\t\t{\t\r\n\t\t\t\t\t\tthis._attributesLookup[ data.attributes[i] ] = data;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else\r\n\t\t\t\t{\r\n\t\t\t\t\tfor (var i in data.attributes)\r\n\t\t\t\t\t{\t\r\n\t\t\t\t\t\tif (typeof this._attributesLookup[i] === 'undefined')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis._attributesLookup[i] = {};\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (typeof this._attributesLookup[i][ data.attributes[i] ] === 'undefined')\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tthis._attributesLookup[i][ data.attributes[i] ] = {};\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis._attributesLookup[i][ data.attributes[i] ] = data;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (data.classes) \r\n\t\t\t{\r\n\t\t\t\tfor (var i in data.classes)\r\n\t\t\t\t{\t\r\n\t\t\t\t\tthis._classesLookup[ data.classes[i] ] = data;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (data.classesRegex) \r\n\t\t\t{\r\n\t\t\t\tfor (var i in data.classesRegex)\r\n\t\t\t\t{\t\r\n\t\t\t\t\tthis._classesRegexLookup[ data.classesRegex[i] ] = data;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\textend: function(inheritType, type, data) {\r\n\t\t\t \r\n\t\t\t var newData = data;\r\n\t\t\t \r\n\t\t\t if (inheritData = this._components[inheritType])\r\n\t\t\t {\r\n\t\t\t\tnewData = langx.extend(true,{}, inheritData, data);\r\n\t\t\t\tnewData.properties = langx.merge( langx.merge([], inheritData.properties?inheritData.properties:[]), data.properties?data.properties:[]);\r\n\t\t\t }\r\n\t\t\t \r\n\t\t\t //sort by order\r\n\t\t\t newData.properties.sort(function (a,b) \r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof a.sort  === \"undefined\") a.sort = 0;\r\n\t\t\t\t\tif (typeof b.sort  === \"undefined\") b.sort = 0;\r\n\r\n\t\t\t\t\tif (a.sort < b.sort)\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\tif (a.sort > b.sort)\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t});\r\n\t/*\t\t \r\n\t\t\tvar output = array.reduce(function(o, cur) {\r\n\r\n\t\t\t  // Get the index of the key-value pair.\r\n\t\t\t  var occurs = o.reduce(function(n, item, i) {\r\n\t\t\t\treturn (item.key === cur.key) ? i : n;\r\n\t\t\t  }, -1);\r\n\r\n\t\t\t  // If the name is found,\r\n\t\t\t  if (occurs >= 0) {\r\n\r\n\t\t\t\t// append the current value to its list of values.\r\n\t\t\t\to[occurs].value = o[occurs].value.concat(cur.value);\r\n\r\n\t\t\t  // Otherwise,\r\n\t\t\t  } else {\r\n\r\n\t\t\t\t// add the current item to o (but make sure the value is an array).\r\n\t\t\t\tvar obj = {name: cur.key, value: [cur.value]};\r\n\t\t\t\to = o.concat([obj]);\r\n\t\t\t  }\r\n\r\n\t\t\t  return o;\r\n\t\t\t}, newData.properties);\t\t \r\n\t*/\r\n\t\t\t\r\n\t\t\tthis.add(type, newData);\r\n\t\t},\r\n\t\t\r\n\t\t\r\n\t\tmatchNode: function(node) {\r\n\t\t\tvar component = {};\r\n\t\t\t\r\n\t\t\tif (!node || !node.tagName) return false;\r\n\t\t\t\r\n\t\t\tif (node.attributes && node.attributes.length)\r\n\t\t\t{\r\n\t\t\t\t//search for attributes\r\n\t\t\t\tfor (var i in node.attributes)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (node.attributes[i])\r\n\t\t\t\t\t{\r\n\t\t\t\t\tattr = node.attributes[i].name;\r\n\t\t\t\t\tvalue = node.attributes[i].value;\r\n\r\n\t\t\t\t\tif (attr in this._attributesLookup) \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcomponent = this._attributesLookup[ attr ];\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//currently we check that is not a component by looking at name attribute\r\n\t\t\t\t\t\t//if we have a collection of objects it means that attribute value must be checked\r\n\t\t\t\t\t\tif (typeof component[\"name\"] === \"undefined\")\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (value in component)\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn component[value];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else \r\n\t\t\t\t\t\treturn component;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\tfor (var i in node.attributes)\r\n\t\t\t\t{\r\n\t\t\t\t\tattr = node.attributes[i].name;\r\n\t\t\t\t\tvalue = node.attributes[i].value;\r\n\t\t\t\t\t\r\n\t\t\t\t\t//check for node classes\r\n\t\t\t\t\tif (attr == \"class\")\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclasses = value.split(\" \");\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor (j in classes) \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif (classes[j] in this._classesLookup)\r\n\t\t\t\t\t\t\treturn this._classesLookup[ classes[j] ];\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor (regex in this._classesRegexLookup) \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tregexObj = new RegExp(regex);\r\n\t\t\t\t\t\t\tif (regexObj.exec(value)) \r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\treturn this._classesRegexLookup[ regex ];\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\ttagName = node.tagName.toLowerCase();\r\n\t\t\tif (tagName in this._nodesLookup) return this._nodesLookup[ tagName ];\r\n\t\t\r\n\t\t\treturn false;\r\n\t\t\t//return false;\r\n\t\t},\r\n\t\t\r\n\t\trender: function(type) {\r\n\r\n\t\t\tvar component = this._components[type];\r\n\t\t\t\r\n\t\t\tvar rightPanel = jQuery(this.componentPropertiesElement);\r\n\t\t\tvar section = rightPanel.find('.section[data-section=\"default\"]');\r\n\t\t\t\r\n\t\t\tif (!(Vvveb.preservePropertySections && section.length))\r\n\t\t\t{\r\n\t\t\t\trightPanel.html('').append(tmpl(\"vvveb-input-sectioninput\", {key:\"default\", header:component.name}));\r\n\t\t\t\tsection = rightPanel.find(\".section\");\r\n\t\t\t}\r\n\r\n\t\t\trightPanel.find('[data-header=\"default\"] span').html(component.name);\r\n\t\t\tsection.html(\"\")\t\r\n\t\t\r\n\t\t\tif (component.beforeInit) component.beforeInit(Vvveb.Builder.selectedEl.get(0));\r\n\t\t\t\r\n\t\t\tvar element;\r\n\t\t\t\r\n\t\t\tvar fn = function(component, property) {\r\n\t\t\t\treturn property.input.on('propertyChange', function (event, value, input) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tvar element = Vvveb.Builder.selectedEl;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (property.child) element = element.find(property.child);\r\n\t\t\t\t\t\tif (property.parent) element = element.parent(property.parent);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (property.onChange)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\telement = property.onChange(element, value, input, component);\r\n\t\t\t\t\t\t}/* else */\r\n\t\t\t\t\t\tif (property.htmlAttr)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toldValue = element.attr(property.htmlAttr);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif (property.htmlAttr == \"class\" && property.validValues) \r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\telement.removeClass(property.validValues.join(\" \"));\r\n\t\t\t\t\t\t\t\telement = element.addClass(value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (property.htmlAttr == \"style\") \r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\telement = element.css(property.key, value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\telement = element.attr(property.htmlAttr, value);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tVvveb.Undo.addMutation({type: 'attributes', \r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttarget: element.get(0), \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tattributeName: property.htmlAttr, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\toldValue: oldValue, \r\n\t\t\t\t\t\t\t\t\t\t\t\t\tnewValue: element.attr(property.htmlAttr)});\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (component.onChange) \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\telement = component.onChange(element, property, value, input);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif (!property.child && !property.parent) Vvveb.Builder.selectNode(element);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn element;\r\n\t\t\t\t});\t\t\t\t\r\n\t\t\t};\t\t\t\r\n\t\t\r\n\t\t\tvar nodeElement = Vvveb.Builder.selectedEl;\r\n\r\n\t\t\tfor (var i in component.properties)\r\n\t\t\t{\r\n\t\t\t\tvar property = component.properties[i];\r\n\t\t\t\tvar element = nodeElement;\r\n\t\t\t\t\r\n\t\t\t\tif (property.beforeInit) property.beforeInit(element.get(0)) \r\n\t\t\t\t\r\n\t\t\t\tif (property.child) element = element.find(property.child);\r\n\t\t\t\t\r\n\t\t\t\tif (property.data) {\r\n\t\t\t\t\tproperty.data[\"key\"] = property.key;\r\n\t\t\t\t} else\r\n\t\t\t\t{\r\n\t\t\t\t\tproperty.data = {\"key\" : property.key};\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (typeof property.group  === 'undefined') property.group = null;\r\n\r\n\t\t\t\tproperty.input = property.inputtype.init(property.data);\r\n\t\t\t\t\r\n\t\t\t\tif (property.init)\r\n\t\t\t\t{\r\n\t\t\t\t\tproperty.inputtype.setValue(property.init(element.get(0)));\r\n\t\t\t\t} else if (property.htmlAttr)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (property.htmlAttr == \"style\")\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t//value = element.css(property.key);//jquery css returns computed style\r\n\t\t\t\t\t\tvar value =  Vvveb.getStyle(element.get(0), property.key);//getStyle returns declared style\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar value = element.attr(property.htmlAttr);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//if attribute is class check if one of valid values is included as class to set the select\r\n\t\t\t\t\tif (value && property.htmlAttr == \"class\" && property.validValues)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvalue = value.split(\" \").filter(function(el) {\r\n\t\t\t\t\t\t\treturn property.validValues.indexOf(el) != -1\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} \r\n\r\n\t\t\t\t\tproperty.inputtype.setValue(value);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfn(component, property);\r\n\r\n\t\t\t\tif (property.inputtype == inputs.SectionInput)\r\n\t\t\t\t{\r\n\t\t\t\t\tsection = rightPanel.find('.section[data-section=\"' + property.key + '\"]');\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (Vvveb.preservePropertySections && section.length)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tsection.html(\"\");\r\n\t\t\t\t\t} else \r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trightPanel.append(property.input);\r\n\t\t\t\t\t\tsection = rightPanel.find('.section[data-section=\"' + property.key + '\"]');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\tvar row = $(tmpl('vvveb-property', property)); \r\n\t\t\t\t\trow.find('.input').append(property.input);\r\n\t\t\t\t\tsection.append(row);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (property.inputtype.afterInit)\r\n\t\t\t\t{\r\n\t\t\t\t\tproperty.inputtype.afterInit(property.input);\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (component.init) component.init(Vvveb.Builder.selectedEl.get(0));\r\n\t\t}\r\n\t};\t\r\n});"]}