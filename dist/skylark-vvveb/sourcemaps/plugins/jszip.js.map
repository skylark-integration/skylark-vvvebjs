{"version":3,"sources":["plugins/jszip.js"],"names":["define","$","Gui","download","addUrl","url","indexOf","isLocalUrl","assets","push","html","Vvveb","Builder","frameHtml","each","i","e","getAttribute","console","dir"],"mappings":";;;;;;;AAACA,QACG,0BACA,UACF,SAASC,EAAEC,GACV,OAAOA,EAAIC,SAAW,WAOjB,SAASC,EAAOC,IALhB,SAAoBA,GAEhB,OAA6B,GAAtBA,EAAIC,QAAQ,OAKfC,CAAWF,IAAMG,EAAOC,KAAKJ,GAIrC,IAAIK,EAAOC,MAAMC,QAAQC,UACrBL,KAGJP,EAAE,qBAAsBS,GAAMI,KAAK,SAASC,EAAGC,GAC3CZ,EAAOY,EAAEC,aAAa,WAI1BhB,EAAE,qBAAsBS,GAAMI,KAAK,SAASC,EAAGC,GAC3CZ,EAAOY,EAAEC,aAAa,UAI1BhB,EAAE,WAAYS,GAAMI,KAAK,SAASC,EAAGC,GACjCZ,EAAOY,EAAEC,aAAa,UAG1BC,QAAQC,IAAIX","file":"../../plugins/jszip.js","sourcesContent":[" define([\r\n    \"skylark-utils-dom/query\",\r\n    \"../Gui\"\r\n],function($,Gui){\r\n   return Gui.download = function () {\r\n\r\n        function isLocalUrl(url)\r\n        {\r\n            return url.indexOf(\"//\") == -1;\r\n        }\r\n\r\n        function addUrl(url)\r\n        {\r\n            if (isLocalUrl(url)) assets.push(url);\r\n        }\r\n\r\n\r\n        var html = Vvveb.Builder.frameHtml;\r\n        var assets = [];\r\n\r\n        //stylesheets\r\n        $(\"link[href$='.css']\", html).each(function(i, e) {\r\n            addUrl(e.getAttribute(\"href\"));\r\n        });\r\n\r\n        //javascript\r\n        $(\"script[src$='.js']\", html).each(function(i, e) {\r\n            addUrl(e.getAttribute(\"src\"));\r\n        });\r\n        \r\n        //images\r\n        $(\"img[src]\", html).each(function(i, e) {\r\n            addUrl(e.getAttribute(\"src\"));\r\n        });\r\n\r\n        console.dir(assets);\r\n        return;\r\n\r\n        var zip = new JSZip();\r\n        zip.file(\"Hello.txt\", \"Hello World\\n\");\r\n        var img = zip.folder(\"images\");\r\n        img.file(\"smile.gif\", imgData, {base64: true});\r\n        zip.generateAsync({type:\"blob\"})\r\n        .then(function(content) {\r\n            // see FileSaver.js\r\n            saveAs(content, \"template.zip\");\r\n        });\r\n    };\r\n    /*\r\n\r\n    filename = /[^\\/]+$/.exec(Vvveb.Builder.iframe.src)[0];\r\n    uriContent = \"data:application/octet-stream,\"  + encodeURIComponent(Vvveb.Builder.getHtml());\r\n\r\n    var link = document.createElement('a');\r\n    if ('download' in link)\r\n    {\r\n        link.download = filename;\r\n        link.href = uriContent;\r\n        link.target = \"_blank\";\r\n        \r\n        document.body.appendChild(link);\r\n        result = link.click();\r\n        document.body.removeChild(link);\r\n        link.remove();\r\n        \r\n    } else\r\n    {\r\n        location.href = uriContent;\r\n    }\r\n\r\n\r\n    var zip = new JSZip();\r\n    zip.file(\"Hello.txt\", \"Hello World\\n\");\r\n    var img = zip.folder(\"images\");\r\n    img.file(\"smile.gif\", imgData, {base64: true});\r\n    zip.generateAsync({type:\"blob\"})\r\n    .then(function(content) {\r\n        // see FileSaver.js\r\n        saveAs(content, \"example.zip\");\r\n    });\r\n*/\r\n});"]}